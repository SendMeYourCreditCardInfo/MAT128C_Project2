format long e;
%%2.a
f = @(t,y) (-0.5)*exp(2*t) + t^2 +2*t - 0.5;
g = @(t,y) (0.5)*exp(2*t) + t^2 - 0.5;
syms y;
t =0;
N = 1/0.1;
h = 0.1;
F = [];
G = [];
for i = 1:N+1
    F(i) = f(t,y);
    G(i) = g(t,y);
    t = t + i*h;
end

w1 = [F'];
w2 = [G'];
Outa = table(w1,w2);

%% 2.b
f = @(t,y) -3*exp(t) + t^2;
g = @(t,y) 4*exp(t) - 3*t + 1;
syms y;
t =0;
N = 1/0.1;
h = 0.2;
F = [];
G = [];
for i = 1:N+1
    F(i) = f(t,y);
    G(i) = g(t,y);
    t = t + i*h;
end

w3 = [F'];
w4 = [G'];
Outb = table(w3,w4);

%% 2.c
f = @(t,y) -3*exp(-t) - 3*sin(t) + 6*cos(t);
g = @(t,y) (3/2)*exp(-t) + (3/10)*sin(t) - (21/10)*cos(t) - (2/5)*exp(2*t);
j = @(t,y) -exp(-t) + (12/5)*cos(t) + (9/5)*sin(t) - (2/5)*exp(2*t);
syms y;
t =0;
N = 1/0.1;
h = 0.1;
F = [];
G = [];
J = [];
for i = 1:N+1
    F(i) = f(t,y);
    G(i) = g(t,y);
    J(i) = j(t,y);
    t = t + i*h;
end

w5 = [F'];
w6 = [G'];
w7 = [J'];
Outc = table(w5, w6,w7)

%% 2.d
f = @(t,y) 2*exp(3*t) + 3*exp(-2*t) + t;
g = @(t,y) -8*exp(-2*t) + exp(4*t) - 2*exp(3*t) + sin(t);
j = @(t,y) 2*exp(4*t) - 4*exp(3*t) - exp(-2*t) - 2;
syms y;
t =0;
N = 1/0.1;
h = 0.1;
F = [];
G = [];
J = [];
for i = 1:N+1
    F(i) = f(t,y);
    G(i) = g(t,y);
    J(i) = j(t,y);
    t = t + i*h;
end

w8 = [F'];
w9 = [G'];
w10 = [J'];
Outd = table(w8, w9, w10)


%% Maple Tables
HW2a = [0.000 -1.00000000  0.00000000
0.100 -0.90070000  0.12070000
0.200 -0.80590898  0.28590898
0.300 -0.72105323  0.50105323
0.400 -0.65276041  0.77276041
0.500 -0.60912557  1.10912557
0.600 -0.60003597  1.52003597
0.700 -0.63756793  2.01756793
0.800 -0.73647147  2.61647147
0.900 -0.91476226  3.33476226
1.000 -1.19444462  4.19444462];

HW2b = [0.000 -3.00000000  5.00000000
0.200 -3.62420001  5.28560000
0.400 -4.31545390  5.76727184
0.600 -5.10631940  6.48842582
0.800 -6.03656252  7.50208330
1.000 -7.15475346  8.87300454
1.200 -8.52021587 10.68028775
1.400 -10.20540766 13.02054346
1.600 -12.29882890 16.01177178
1.800 -14.90857362 19.79809804
2.000 -18.16666781 24.55555695];

HW2c = [0.000  3.00000000 -1.00000000  1.00000000
0.100  2.95601283 -1.19086301  1.17431207
0.200  2.82820001 -1.36717100  1.29430535
0.300  2.62300502 -1.53516736  1.35508120
0.400  2.34715282 -1.70213314  1.35096843
0.500  2.00762954 -1.87660336  1.27532972
0.600  1.61165492 -2.06862759  1.12031748
0.700  1.16664855 -2.29008513  0.87656855
0.800  0.68019035 -2.55506790  0.53282506
0.900  0.15997622 -2.88034679  0.07546587
1.000 -0.38623048 -3.28594071 -0.51207026];

HW2d = [0.000  5.00000000 -9.00000000 -5.00000000
0.200  5.85399925 -6.58493690 -5.51120222
0.400  8.38330900 -4.90201610 -5.84129949
0.600 13.58890681 -2.95418927 -4.51808620
0.800 23.41761332  1.48419015  2.56362979
1.000 41.49825592 13.88034475 26.10907731
1.200 74.49594922 47.66792292 92.83361931
1.400 134.58778600 135.26098840 267.46411360
1.600 243.97809730 353.50436490 703.62173380
1.800 443.12659480 882.03172470 1760.52619100
2.000 805.73782190 2136.25111200 4268.95883500];

%% Comparing the Approx. with Exact
c2aw1 = [];
c2aw2 = [];
c2bw3 = [];
c2bw4 = [];
c2cw5 = [];
c2cw6 = [];
c2cw7 = [];
c2dw8 = [];
c2dw9 = [];
c2dw10 = [];

for v = 1:11
c2aw1(v) = abs(w1(v) - HW2a(v,2));
c2aw2(v) = abs(w2(v) - HW2a(v,3));
c2bw3(v) = abs(w3(v) - HW2b(v,2));
c2bw4(v) = abs(w4(v) - HW2b(v,3));
c2cw5(v) = abs(w5(v) - HW2c(v,2));
c2cw6(v) = abs(w6(v) - HW2c(v,3));
c2cw7(v) = abs(w7(v) - HW2c(v,4));
c2dw8(v) = abs(w8(v) - HW2d(v,2));
c2dw9(v) = abs(w9(v) - HW2d(v,3));
c2dw10(v) = abs(w10(v) - HW2d(v,4));
end
fprintf('Comparing the Approximations for each problem\n\n');
fprintf('Error for 2.a w1 and w2\n');
display(c2aw1');
display(c2aw2');
fprintf('Error for 2.b w1 and w2\n');
display(c2bw3');
display(c2bw4');
fprintf('Error for 2.c w1 and w2 and w3\n');
display(c2cw5');
display(c2cw6');
display(c2cw7');
fprintf('Error for 2.d w1 and w2 and w3\n');
display(c2dw8');
display(c2dw9');
display(c2dw10');